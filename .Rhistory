#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_10k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop!=750,]
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1)) + geom_line(position=position_dodge(.1))+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_100k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop!=750,]
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1)) + geom_line(position=position_dodge(.1)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop!=750,]
p <- ggplot(data_final,aes(x=pop,y=mn)) +
geom_point(position=position_dodge(.1)) + geom_line(position=position_dodge(.1))+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_10000k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop!=750,]
p <- ggplot(data_final,aes(x=pop,y=mn)) +
geom_point(position=position_dodge(.1)) + geom_line(position=position_dodge(.1))+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
data1 <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_10k/peak_fractions_bs_100.csv")
data2 <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_100k/peak_fractions_bs_100.csv")
data3 <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs_100.csv")
data_l_agg1 <- aggregate(x=data1["p1"],by=list(pop=data1$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_l_agg2 <- aggregate(x=data2["p1"],by=list(pop=data2$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_l_agg3 <- aggregate(x=data3["p1"],by=list(pop=data3$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final1 <- do.call(data.frame,data_l_agg1)
data_final2 <- do.call(data.frame,data_l_agg2)
data_final3 <- do.call(data.frame,data_l_agg3)
colnames(data_final1)[2] <- "mn"
colnames(data_final1)[3] <- "stdev"
data_final1 <- data_final1[data_final1$pop==50 & data_final1$pop==500 & data_final1$pop==1000,]
colnames(data_final2)[2] <- "mn"
colnames(data_final2)[3] <- "stdev"
data_final2 <- data_final2[data_final2$pop==50 & data_final2$pop==500 & data_final2$pop==1000,]
colnames(data_final3)[2] <- "mn"
colnames(data_final3)[3] <- "stdev"
data_final3 <- data_final1[data_final3$pop==50 & data_final3$pop==500 & data_final3$pop==1000,]
p <- ggplot(data_final,aes(x=pop,y=mn)) + ggplot(data_final2,aes(x=pop,y=mn)) + ggplot(data_final3,aes(x=pop,y=mn))+
geom_point(position=position_dodge(.1)) + geom_line(position=position_dodge(.1))+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_10k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 & data_final$pop=500 & data_final$pop==1000,]
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1)) + geom_line(position=position_dodge(.1))+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_10k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 & data_final$pop=500 & data_final$pop==1000,]
p <- ggplot(data_final,aes(x=pop,y=mn,fill="d5d5ff")) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1)) + geom_line(position=position_dodge(.1))+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
p <- ggplot(data_final,aes(x=pop,y=mn,fill="d5d5ff",color="d5d5ff")) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1)) + geom_line(position=position_dodge(.1))+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
p <- ggplot(data_final,aes(x=pop,y=mn,fill="#d5d5ff",color="#d5d5ff")) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1)) + geom_line(position=position_dodge(.1))+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill="#d5d5ff",color="#d5d5ff") + geom_line(position=position_dodge(.1))+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1))+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1)) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
acc <- "#d5d5ff"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
data_final <- data_final[data_final$pop==50 | data_final$pop=500  | data_final$pop==1000,]
data_final <- data_final[data_final$pop==50 | data_final$pop==500  | data_final$pop==1000,]
acc <- "#d5d5ff"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_100k/peak_fractions_bs_100.csv")
names(data)
data
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_100k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 | data_final$pop==500  | data_final$pop==1000,]
acc <- "#aaaaff"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 | data_final$pop==500  | data_final$pop==1000,]
acc <- "#3737c8"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 | data_final$pop==200 | data_final$pop==500  | data_final$pop==1000,]
acc <- "#3737c8"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_100k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 | data_final$pop==200 | data_final$pop==500  | data_final$pop==1000,]
acc <- "#aaaaff"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_10k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 | data_final$pop==200 | data_final$pop==500  | data_final$pop==1000,]
acc <- "#d5d5ff"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_10k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 | data_final$pop==200 | data_final$pop==500  | data_final$pop==1000,]
acc <- "#d5d5ff"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_100k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 | data_final$pop==200 | data_final$pop==500  | data_final$pop==1000,]
acc <- "#aaaaff"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 | data_final$pop==200 | data_final$pop==500  | data_final$pop==1000,]
acc <- "#3737c8"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_line(position=position_dodge(.1),fill=acc,color=acc)+
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
#data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_1000k/peak_fractions_bs.csv")
data <- read.csv("~/wsl_files/rblab/rblab_figures/testing/interm_pops_hmut_10k/peak_fractions_bs_100.csv")
names(data)
data
data_l_agg <- aggregate(x=data["p1"],by=list(pop=data$pop),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_final <- do.call(data.frame,data_l_agg)
names(data_final)
colnames(data_final)[2] <- "mn"
colnames(data_final)[3] <- "stdev"
data_final <- data_final[data_final$pop==50 | data_final$pop==200 | data_final$pop==500  | data_final$pop==1000,]
acc <- "#d5d5ff"
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_smooth(method = "glm", family = binomial, se = FALSE) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_smooth() +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_smooth(method = "glm", family = binomial, se = FALSE) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
p <- ggplot(data_final,aes(x=pop,y=mn)) + #geom_line(data=data_final2,colour="blue") +
geom_point(position=position_dodge(.1),fill=acc,color=acc) + geom_smooth() +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1),fill=acc,color=acc) + theme_minimal() +
theme(axis.text.x = element_text(angle =45),legend.position = "None")
p  + xlab("Population") + ylab("Fraction of genotypes (Peak 1)") + labs(color="Carrying capacity") + ylim(0,0.4)
library(ggplot2)
data <- read.csv("analysis/accuracies.csv")
data$abs_slope <- as.factor(data$abs_slope)
p <- ggplot(data,aes(x=noise,y=accuracy,color=abs_slope)) + geom_point() + theme_minimal() + scale_x_reverse()
p + ylim(0,100)
setwd("~/wsl_files/ns201_code")
library(ggplot2)
data <- read.csv("~/wsl_files/ns201_code/analysis/accuracies.csv")
data$abs_slope <- as.factor(data$abs_slope)
p <- ggplot(data,aes(x=noise,y=accuracy,color=abs_slope)) + geom_point() + theme_minimal() + scale_x_reverse()
p + ylim(0,100)
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
colnames(data_final)[3] <- "mn"
colnames(data_final)[4] <- "stdev"
library(ggplot2)
data <- read.csv("~/wsl_files/ns201_code/analysis/accuracies.csv")
data$abs_slope <- as.factor(data$abs_slope)
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
summary(data_agg)
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
summary(data_agg)
colnames(data_agg)[3] <- "mn"
colnames(data_agg)[4] <- "stdev"
library(ggplot2)
data <- read.csv("~/wsl_files/ns201_code/analysis/accuracies.csv")
data$abs_slope <- as.factor(data$abs_slope)
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
summary(data_agg)
colnames(data_agg)[3] <- "mn"
colnames(data_agg)[4] <- "stdev"
library(ggplot2)
data <- read.csv("~/wsl_files/ns201_code/analysis/accuracies.csv")
data$abs_slope <- as.factor(data$abs_slope)
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
summary(data_agg)
colnames(data_agg)[2] <- "mn"
colnames(data_agg)[3] <- "stdev"
data_agg
library(ggplot2)
data <- read.csv("~/wsl_files/ns201_code/analysis/accuracies.csv")
data$abs_slope <- as.factor(data$abs_slope)
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
summary(data_agg)
colnames(data_agg)[3] <- "mn"
colnames(data_agg)[4] <- "stdev"
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
names(data_agg)
colnames(data_agg)[3] <- "mn"
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
names(data_agg)
colnames(data_agg)[3][1] <- "mn"
colnames(data_agg)[4][2] <- "stdev"
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
names(data_agg)
data_agg <- do.call(data.frame,data_agg)
colnames(data_agg)[3] <- "mn"
colnames(data_agg)[4] <- "stdev"
p <- ggplot(data,aes(x=noise,y=accuracy,color=abs_slope)) + geom_point() + theme_minimal() + scale_x_reverse()
p + ylim(0,100)
p <- ggplot(data,aes(x=noise,y=accuracy,color=abs_slope)) +
geom_point(position=position_dodge(.1)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1))+
theme_minimal() + scale_x_reverse()
p + ylim(0,100)
p <- ggplot(data_agg,aes(x=noise,y=accuracy,color=abs_slope)) +
geom_point(position=position_dodge(.1)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1))+
theme_minimal() + scale_x_reverse()
p + ylim(0,100)
p <- ggplot(data_agg,aes(x=noise,y=accuracy,color=slope)) +
geom_point(position=position_dodge(.1)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1))+
theme_minimal() + scale_x_reverse()
p + ylim(0,100)
library(ggplot2)
data <- read.csv("~/wsl_files/ns201_code/analysis/accuracies.csv")
data$abs_slope <- as.factor(data$abs_slope)
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_agg <- do.call(data.frame,data_agg)
colnames(data_agg)[3] <- "mn"
colnames(data_agg)[4] <- "stdev"
names(data_agg)
p <- ggplot(data_agg,aes(x=noise,y=accuracy,color=slope)) +
geom_point(position=position_dodge(.1)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1))+
theme_minimal() + scale_x_reverse()
p + ylim(0,100)
p <- ggplot(data_agg,aes(x=noise,y=mn,color=slope)) +
geom_point(position=position_dodge(.1)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.1))+
theme_minimal() + scale_x_reverse()
p + ylim(0,100)
p <- ggplot(data_agg,aes(x=noise,y=mn,color=slope)) +
geom_point(position=position_dodge(.001)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.3,
position=position_dodge(.001))+
theme_minimal() + scale_x_reverse()
p + ylim(0,100)
p <- ggplot(data_agg,aes(x=noise,y=mn,color=slope)) +
geom_point(position=position_dodge(.001)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.001,
position=position_dodge(.001))+
theme_minimal() + scale_x_reverse()
p + ylim(0,100)
p <- ggplot(data_agg,aes(x=noise,y=mn,color=slope)) +
geom_point() +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.02)+
theme_minimal() + scale_x_reverse()
p + ylim(0,100)
library(ggplot2)
data <- read.csv("~/wsl_files/ns201_code/analysis/accuracies.csv")
data$abs_slope <- as.factor(data$abs_slope)
data_agg <- aggregate(x=data["accuracy"],by=list(slope=data$abs_slope,noise=data$noise),FUN=function(x) c(mn = mean(x), stdev = sd(x)))
data_agg <- do.call(data.frame,data_agg)
colnames(data_agg)[3] <- "mn"
colnames(data_agg)[4] <- "stdev"
names(data_agg)
p <- ggplot(data_agg,aes(x=noise,y=mn,color=slope)) +
geom_point() +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.02)+
theme_minimal() + scale_x_reverse() +
xlab("Noise (SD of Gaussian noise)") + ylab("Accuracy") + labs(color="mean slope")
p + ylim(0,100)
p <- ggplot(data_agg,aes(x=noise,y=mn,color=slope)) +
geom_point(position=position_dodge(.01)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.005)+
theme_minimal() + scale_x_reverse() +
xlab("Noise (SD of Gaussian noise)") + ylab("Accuracy") + labs(color="mean slope")
p + ylim(0,100)
p <- ggplot(data_agg,aes(x=noise,y=mn,color=slope)) +
geom_point(position=position_dodge(.01)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.005,position=position_dodge(.01))+
theme_minimal() + scale_x_reverse() +
xlab("Noise (SD of Gaussian noise)") + ylab("Accuracy") + labs(color="mean slope")
p + ylim(0,100)
p <- ggplot(data_agg,aes(x=noise,y=mn,color=slope)) +
geom_point(position=position_dodge(.01)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=.005,position=position_dodge(.01))+
theme_minimal() + scale_x_reverse() +
xlab("Noise (SD of Gaussian noise)") + ylab("Accuracy") + labs(color="mean slope")
p + ylim(0,200)
p <- ggplot(data_agg,aes(x=noise,y=mn,color=slope)) +
geom_point(position=position_dodge(.02)) +
geom_errorbar(aes(ymin=mn-stdev,ymax=mn+stdev),width=0,position=position_dodge(.02))+
theme_minimal() + scale_x_reverse() +
xlab("Noise (SD of Gaussian noise)") + ylab("Accuracy") + labs(color="mean slope")
p + coord_cartesian(ylim=c(0, 100))
